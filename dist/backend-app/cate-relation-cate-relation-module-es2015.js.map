{"version":3,"sources":["./src/app/pages/cate-relation/cate-relation.component.html","./src/app/pages/cate-relation/cate-relation-routing.module.ts","./src/app/pages/cate-relation/cate-relation.component.scss","./src/app/pages/cate-relation/cate-relation.component.ts","./src/app/pages/cate-relation/cate-relation.module.ts"],"names":[],"mappings":"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","file":"cate-relation-cate-relation-module-es2015.js","sourcesContent":["export default \"<nz-skeleton [nzActive]=\\\"true\\\" *ngIf=\\\"!cateList\\\" [nzParagraph]=\\\"{ rows: 10 }\\\"></nz-skeleton>\\n<nz-tabset style=\\\"height:100%;\\\" nzTabPosition=\\\"left\\\">\\n  <nz-tab *ngFor=\\\"let cate of cateList\\\" [nzTitle]=\\\"cate.name\\\" (nzSelect)=\\\"onSelect(cate.id)\\\">\\n    <nz-checkbox-wrapper style=\\\"width: 100%;\\\">\\n      <div nz-row>\\n        <div nz-col nzSpan=\\\"6\\\" *ngFor=\\\"let sub of subCateList\\\">\\n          <label nz-checkbox [nzValue]=\\\"sub.id\\\" [(ngModel)]=\\\"sub.checked\\\">{{sub.name}}</label>\\n          <img [src]=\\\"sub.img\\\">\\n        </div>\\n      </div>\\n    </nz-checkbox-wrapper>\\n\\n    <button nz-button nzValue=\\\"large\\\" nzType=\\\"primary\\\" (click)=\\\"onSave()\\\" [nzLoading]=\\\"isLoading\\\">Save</button>\\n  </nz-tab>\\n</nz-tabset>\\n\"","import {NgModule} from '@angular/core';\nimport {Routes, RouterModule} from '@angular/router';\nimport {CateRelationComponent} from './cate-relation.component';\n\n\nconst routes: Routes = [{path: '', component: CateRelationComponent}];\n\n@NgModule({\n  imports: [RouterModule.forChild(routes)],\n  exports: [RouterModule]\n})\nexport class CateRelationRoutingModule {\n}\n","export default \"img {\\n  width: 60px;\\n}\\n\\n[nz-button] {\\n  margin-top: 38px;\\n}\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNyYy9hcHAvcGFnZXMvY2F0ZS1yZWxhdGlvbi9FOlxcV29ya1xcSW9uaWMgTW9iaWxlIEFwcFxcS2hpbWVzYXJhIFNpbGsgTWlsbHNcXGFwcC1iYWNrZW5kL3NyY1xcYXBwXFxwYWdlc1xcY2F0ZS1yZWxhdGlvblxcY2F0ZS1yZWxhdGlvbi5jb21wb25lbnQuc2NzcyIsInNyYy9hcHAvcGFnZXMvY2F0ZS1yZWxhdGlvbi9jYXRlLXJlbGF0aW9uLmNvbXBvbmVudC5zY3NzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBO0VBQ0UsV0FBQTtBQ0NGOztBREVBO0VBQ0UsZ0JBQUE7QUNDRiIsImZpbGUiOiJzcmMvYXBwL3BhZ2VzL2NhdGUtcmVsYXRpb24vY2F0ZS1yZWxhdGlvbi5jb21wb25lbnQuc2NzcyIsInNvdXJjZXNDb250ZW50IjpbImltZyB7XHJcbiAgd2lkdGg6IDYwcHg7XHJcbn1cclxuXHJcbltuei1idXR0b25dIHtcclxuICBtYXJnaW4tdG9wOiAzOHB4O1xyXG59XHJcbiIsImltZyB7XG4gIHdpZHRoOiA2MHB4O1xufVxuXG5bbnotYnV0dG9uXSB7XG4gIG1hcmdpbi10b3A6IDM4cHg7XG59Il19 */\"","import {Component, OnInit} from '@angular/core';\nimport {\n  CateModel,\n  CateRelationModel,\n  CateRelationService,\n  CateService,\n  ModalService,\n  PageDataService,\n  SubCateModel,\n  SubCateService\n} from '../../shared';\nimport {forkJoin} from 'rxjs';\n\n\n@Component({\n  selector: 'app-cate-relation',\n  templateUrl: './cate-relation.component.html',\n  styleUrls: ['./cate-relation.component.scss']\n})\nexport class CateRelationComponent implements OnInit {\n  cateList: Array<CateModel>;\n  subCateList: Array<SubCateModel>;\n  relationList: Array<CateRelationModel>;\n  selectCate: string;\n  isLoading = false;\n\n  constructor(private pageService: PageDataService,\n              private cateService: CateService,\n              private subCateService: SubCateService,\n              private relationService: CateRelationService,\n              private modalService: ModalService) {\n    this.pageService.getList([this.cateService.getList(), this.subCateService.getList(), this.relationService.getList()]).then(results => {\n      this.cateList = results[0];\n      this.subCateList = results[1];\n      this.relationList = results[2];\n      if (this.cateList.length > 0) {\n        this.selectCate = this.cateList[0].id;\n        this.setChecked(this.cateList[0].id);\n      }\n    });\n  }\n\n  ngOnInit() {\n\n  }\n\n  setChecked(id: string) {\n    this.subCateList = this.subCateList.map(sub => {\n      const relation = this.relationList.find(r => r.subCateId === sub.id && r.cateId === id);\n      const subModel = new SubCateModel(sub);\n      if (relation) {\n        subModel.relationId = relation.id;\n        subModel.checked = true;\n      } else {\n        subModel.checked = false;\n      }\n      return subModel;\n    });\n  }\n\n  onSelect(id: string) {\n    this.selectCate = id;\n    this.relationService.getList().subscribe(r => {\n      this.relationList = r;\n      this.setChecked(id);\n    });\n  }\n\n  onSave() {\n    const checked = this.subCateList.some(sub => sub.checked);\n    if (!checked) {\n      this.modalService.warning('Please select sub category');\n      return;\n    }\n    this.isLoading = true;\n    const addArray = [];\n    this.subCateList.map(sub => {\n      if (sub.checked && !sub.relationId) {\n        addArray.push(this.relationService.addModel({cateId: this.selectCate, subCateId: sub.id}));\n      }\n      if (!sub.checked && sub.relationId) {\n        addArray.push(this.relationService.delete(sub.relationId));\n      }\n    });\n\n    forkJoin(addArray).subscribe(() => {\n      this.isLoading = false;\n      this.modalService.success('add success!');\n    });\n  }\n}\n","import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\n\nimport { CateRelationRoutingModule } from './cate-relation-routing.module';\nimport { CateRelationComponent } from './cate-relation.component';\nimport {SharedModule} from '../../shared/shared.module';\n\n\n@NgModule({\n  declarations: [CateRelationComponent],\n  imports: [\n    CommonModule,\n    CateRelationRoutingModule,\n    SharedModule\n  ]\n})\nexport class CateRelationModule { }\n"],"sourceRoot":"webpack:///"}