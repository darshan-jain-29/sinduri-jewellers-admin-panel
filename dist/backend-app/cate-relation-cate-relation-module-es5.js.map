{"version":3,"sources":["src/app/pages/cate-relation/cate-relation.component.html","src/app/pages/cate-relation/cate-relation-routing.module.ts","src/app/pages/cate-relation/cate-relation.component.scss","src/app/pages/cate-relation/cate-relation.component.ts","src/app/pages/cate-relation/cate-relation.module.ts"],"names":[],"mappings":"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","sourcesContent":["export default \"<nz-skeleton [nzActive]=\\\"true\\\" *ngIf=\\\"!cateList\\\" [nzParagraph]=\\\"{ rows: 10 }\\\"></nz-skeleton>\\n<nz-tabset style=\\\"height:100%;\\\" nzTabPosition=\\\"left\\\">\\n  <nz-tab *ngFor=\\\"let cate of cateList\\\" [nzTitle]=\\\"cate.name\\\" (nzSelect)=\\\"onSelect(cate.id)\\\">\\n    <nz-checkbox-wrapper style=\\\"width: 100%;\\\">\\n      <div nz-row>\\n        <div nz-col nzSpan=\\\"6\\\" *ngFor=\\\"let sub of subCateList\\\">\\n          <label nz-checkbox [nzValue]=\\\"sub.id\\\" [(ngModel)]=\\\"sub.checked\\\">{{sub.name}}</label>\\n          <img [src]=\\\"sub.img\\\">\\n        </div>\\n      </div>\\n    </nz-checkbox-wrapper>\\n\\n    <button nz-button nzValue=\\\"large\\\" nzType=\\\"primary\\\" (click)=\\\"onSave()\\\" [nzLoading]=\\\"isLoading\\\">Save</button>\\n  </nz-tab>\\n</nz-tabset>\\n\"","import {NgModule} from '@angular/core';\nimport {Routes, RouterModule} from '@angular/router';\nimport {CateRelationComponent} from './cate-relation.component';\n\n\nconst routes: Routes = [{path: '', component: CateRelationComponent}];\n\n@NgModule({\n  imports: [RouterModule.forChild(routes)],\n  exports: [RouterModule]\n})\nexport class CateRelationRoutingModule {\n}\n","export default \"img {\\n  width: 60px;\\n}\\n\\n[nz-button] {\\n  margin-top: 38px;\\n}\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNyYy9hcHAvcGFnZXMvY2F0ZS1yZWxhdGlvbi9FOlxcV29ya1xcSW9uaWMgTW9iaWxlIEFwcFxcS2hpbWVzYXJhIFNpbGsgTWlsbHNcXGFwcC1iYWNrZW5kL3NyY1xcYXBwXFxwYWdlc1xcY2F0ZS1yZWxhdGlvblxcY2F0ZS1yZWxhdGlvbi5jb21wb25lbnQuc2NzcyIsInNyYy9hcHAvcGFnZXMvY2F0ZS1yZWxhdGlvbi9jYXRlLXJlbGF0aW9uLmNvbXBvbmVudC5zY3NzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBO0VBQ0UsV0FBQTtBQ0NGOztBREVBO0VBQ0UsZ0JBQUE7QUNDRiIsImZpbGUiOiJzcmMvYXBwL3BhZ2VzL2NhdGUtcmVsYXRpb24vY2F0ZS1yZWxhdGlvbi5jb21wb25lbnQuc2NzcyIsInNvdXJjZXNDb250ZW50IjpbImltZyB7XHJcbiAgd2lkdGg6IDYwcHg7XHJcbn1cclxuXHJcbltuei1idXR0b25dIHtcclxuICBtYXJnaW4tdG9wOiAzOHB4O1xyXG59XHJcbiIsImltZyB7XG4gIHdpZHRoOiA2MHB4O1xufVxuXG5bbnotYnV0dG9uXSB7XG4gIG1hcmdpbi10b3A6IDM4cHg7XG59Il19 */\"","import {Component, OnInit} from '@angular/core';\nimport {\n  CateModel,\n  CateRelationModel,\n  CateRelationService,\n  CateService,\n  ModalService,\n  PageDataService,\n  SubCateModel,\n  SubCateService\n} from '../../shared';\nimport {forkJoin} from 'rxjs';\n\n\n@Component({\n  selector: 'app-cate-relation',\n  templateUrl: './cate-relation.component.html',\n  styleUrls: ['./cate-relation.component.scss']\n})\nexport class CateRelationComponent implements OnInit {\n  cateList: Array<CateModel>;\n  subCateList: Array<SubCateModel>;\n  relationList: Array<CateRelationModel>;\n  selectCate: string;\n  isLoading = false;\n\n  constructor(private pageService: PageDataService,\n              private cateService: CateService,\n              private subCateService: SubCateService,\n              private relationService: CateRelationService,\n              private modalService: ModalService) {\n    this.pageService.getList([this.cateService.getList(), this.subCateService.getList(), this.relationService.getList()]).then(results => {\n      this.cateList = results[0];\n      this.subCateList = results[1];\n      this.relationList = results[2];\n      if (this.cateList.length > 0) {\n        this.selectCate = this.cateList[0].id;\n        this.setChecked(this.cateList[0].id);\n      }\n    });\n  }\n\n  ngOnInit() {\n\n  }\n\n  setChecked(id: string) {\n    this.subCateList = this.subCateList.map(sub => {\n      const relation = this.relationList.find(r => r.subCateId === sub.id && r.cateId === id);\n      const subModel = new SubCateModel(sub);\n      if (relation) {\n        subModel.relationId = relation.id;\n        subModel.checked = true;\n      } else {\n        subModel.checked = false;\n      }\n      return subModel;\n    });\n  }\n\n  onSelect(id: string) {\n    this.selectCate = id;\n    this.relationService.getList().subscribe(r => {\n      this.relationList = r;\n      this.setChecked(id);\n    });\n  }\n\n  onSave() {\n    const checked = this.subCateList.some(sub => sub.checked);\n    if (!checked) {\n      this.modalService.warning('Please select sub category');\n      return;\n    }\n    this.isLoading = true;\n    const addArray = [];\n    this.subCateList.map(sub => {\n      if (sub.checked && !sub.relationId) {\n        addArray.push(this.relationService.addModel({cateId: this.selectCate, subCateId: sub.id}));\n      }\n      if (!sub.checked && sub.relationId) {\n        addArray.push(this.relationService.delete(sub.relationId));\n      }\n    });\n\n    forkJoin(addArray).subscribe(() => {\n      this.isLoading = false;\n      this.modalService.success('add success!');\n    });\n  }\n}\n","import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\n\nimport { CateRelationRoutingModule } from './cate-relation-routing.module';\nimport { CateRelationComponent } from './cate-relation.component';\nimport {SharedModule} from '../../shared/shared.module';\n\n\n@NgModule({\n  declarations: [CateRelationComponent],\n  imports: [\n    CommonModule,\n    CateRelationRoutingModule,\n    SharedModule\n  ]\n})\nexport class CateRelationModule { }\n"],"sourceRoot":"webpack:///"}